<%= render "shared/settings"%>

<div class="listings-container">
  <div class="row justify-content-center">
    <div class="col-sm-12 col-lg-6 mb-4">

      <h1>
        Marketplace <i class="fa-solid fa-store nav-icon"></i>
      </h1>

      <%= link_to "Go to Offers tab", offers_path %>

    </div>
  </div>

   <div class="row justify-content-center">
    <div class="col-sm-12 col-lg-6 mb-4">
      <%= form_with url: listings_plants_path, method: :get, class: "d-flex" do %>
        <%= text_field_tag :query,
              params[:query],
              class: "form-control rounded-pill",
              placeholder: "Species/common name"
          %>
        <%= submit_tag "Search", name: "", class: "sp-btn-green-sm ms-2 rounded-pill" %>
      <% end %>
    </div>
  </div>

  <div class="row justify-content-center">
    <div class="col-sm-12 col-lg-6 mb-4">

        <% if @listings.length == 0 %>

          <p>There are no listings for <strong><%= "#{params[:query]}" %></strong>. Try searching for something else.</p>

        <% else %>

          <div class="grid-container">
            <% @listings.each do |listing| %>

              <%= link_to listing_plant_path(listing), :action => 'go' do %>
                <div class="grid-item plant-card">

                  <% if listing.image.attached? %>
                    <%= cl_image_tag listing.image.key, class: "plant-card-image-lg" %>
                  <% else %>
                    <%= image_tag("plant_sample_10.jpg", class: "plant-card-image-lg") %>
                  <% end %>

                  <div class="plant-card-content">
                    <p class="m-0">
                      <strong>
                        <%= listing.nickname %>
                      </strong>
                    </p>
                    <p>
                      <%= listing.plant_info.name %>
                    </p>
                    <p class="m-0">
                      <strong>
                        Commonly known as:
                      </strong>
                    </p>
                    <p>
                      <%= listing.plant_info.common_names%>
                    </p>
                    <div class="lister">
                      <p class="m-0">
                        <strong>
                          Listed by
                        </strong>
                        <%= listing.user.first_name %>
                      </p>
                    </div>
                  </div>

                </div>
              <% end %>

            <% end %>

          </div>
        <% end %>

      </div>
    </div>
  </div>
</div>
