<%= render "shared/settings"%>

<div class="px-3" data-controller="mygarden">
  <div class="d-flex justify-content-center mt-4 mb-3">
    <div class="btn btn-primary disabled rounded-5 mx-2" data-mygarden-target="collectionHeader" data-action="click->mygarden#togglePlant">Plants</div>
    <div class="btn btn-primary rounded-5 mx-2" data-mygarden-target="plantsHeader" data-action="click->mygarden#toggleCollection">Collections</div>
  </div>

  <div class="collection d-none" data-mygarden-target="collection">
  <% if @collections.count == 0 %>
    <div class="d-flex flex-column align-items-center", data-mygarden-target="addCollectionHeader">
      <div>
        <p> You do not have any collections yet </p>
      </div>
      <div>
        <button class="sp-btn-green clickable" data-action="click->mygarden#addCollection">Click to add a collection</button>
      </div>
    </div>
        <%= simple_form_for (@collection), html: { class: "d-none", data: { mygarden_target: "addCollectionForm" } } do |f| %>
      <%= f.input :name, label: 'Your collection title' %>
      <%= f.input :image, as: :file, label: 'Upload a a collection image (optional)' %>
      <%= f.submit "Create a collection", class: 'sp-btn-green'%>
    <% end %>
  <% else %>
    <% @collections.each do |collection| %>
      <div class="row gx-0">
      <%= link_to collection_path(collection), class: 'text-decoration-none' do %>
      <div class="plant-card col-sm-12 col-lg-4 collection-card">
        <%= cl_image_tag collection.image.key, class: "plant-card-image" %>
        <div class="d-flex justify-content-between align-items-center p-2">
          <div>
            <span class="collection-card-label"><%= collection.name %></span>
          </div>
          <div>
            <%= link_to "Delete collection", collection_path(collection), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}, class:"text-decoration-none"%>
          </div>
        </div>
      </div>
      <% end %>
    </div>
    <% end %>
      <div class="d-flex justify-content-center" data-mygarden-target="addAnotherCollectionHeader">
        <button class="sp-btn-green clickable " data-action="click->mygarden#addAnotherCollection">Click to add another collection</button>
      </div>
      <div>
        <%= simple_form_for (@collection), html: { class: "d-none", data: { mygarden_target: "addAnotherCollectionForm" } } do |f| %>
          <%= f.input :name, label: 'Your collection title' %>
          <%= f.input :image, as: :file, label: 'Upload a a collection image (optional)' %>
          <%= f.submit "Create a collection", class: 'sp-btn-green'%>
        <% end %>
      </div>
  <% end %>
  </div>

  <div data-mygarden-target="plants">
  <% @plants.each do |plant| %>
    <div class="row gx-0">
      <div class="plant-card col-sm-12 col-lg-4">
        <% plantinfo = PlantInfo.find(plant.plant_info_id) %>
        <% if plant.image.attached? %>
            <%= cl_image_tag plant.image.key, class: "plant-card-image" %>
        <% else %>
        <% end %>
        <div class="plant-card-content">
          <p><strong>Nickname: </strong><%= plant.nickname %></p>
          <p><strong>Remarks: </strong><%= plant.remarks  %></p>
          <p><strong>Species: </strong><%= plantinfo.name  %></p>
          <p><strong>Watering: </strong><%= plantinfo.watering  %></p>
          <%= link_to "View Details", plant_path(plant) %>
          <%= link_to "Add to a collection", edit_plant_path(plant) %>
        </div>
      </div>
    </div>
  <% end %>

<div></div>


</div>
